(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a606b8e"],{"16e1":function(t,e,n){var a=n("a5ba"),i=n("c6da"),o=n("490d"),s=n("c3fb"),c=n("e7ec"),r=n("b68d"),d=i.Array,u=o("JSON","stringify"),l=c(/./.exec),f=c("".charAt),h=c("".charCodeAt),m=c("".replace),v=c(1..toString),g=/[\uD800-\uDFFF]/g,p=/^[\uD800-\uDBFF]$/,b=/^[\uDC00-\uDFFF]$/,_=function(t,e,n){var a=f(n,e-1),i=f(n,e+1);return l(p,t)&&!l(b,i)||l(b,t)&&!l(p,a)?"\\u"+v(h(t,0),16):t},w=r((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&a({target:"JSON",stat:!0,forced:w},{stringify:function(t,e,n){for(var a=0,i=arguments.length,o=d(i);a<i;a++)o[a]=arguments[a];var c=s(u,null,o);return"string"==typeof c?m(c,g,_):c}})},"5cf7":function(t,e,n){(function(e,n){t.exports=n()})(0,(function(){"use strict";function t(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}var e={read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function n(e,a){function i(n,i,o){if("undefined"!==typeof document){o=t({},a,o),"number"===typeof o.expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=n+"="+e.write(i,n)+s}}function o(t){if("undefined"!==typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],a={},i=0;i<n.length;i++){var o=n[i].split("="),s=o.slice(1).join("=");try{var c=decodeURIComponent(o[0]);if(a[c]=e.read(s,c),t===c)break}catch(r){}}return t?a[t]:a}}return Object.create({set:i,get:o,remove:function(e,n){i(e,"",t({},n,{expires:-1}))},withAttributes:function(e){return n(this.converter,t({},this.attributes,e))},withConverter:function(e){return n(t({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(a)},converter:{value:Object.freeze(e)}})}var a=n(e,{path:"/"});return a}))},"6ead":function(t,e,n){"use strict";var a=n("7c9e").forEach,i=n("a3a6"),o=i("forEach");t.exports=o?[].forEach:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}},"7b2f":function(t,e,n){},8923:function(t,e,n){"use strict";n("7b2f")},"89cf":function(t,e,n){"use strict";var a=n("c3fb"),i=n("7faf"),o=n("e7ec"),s=n("7314"),c=n("4d08"),r=n("16bc"),d=n("41be"),u=n("4228"),l=n("3975"),f=n("568e"),h=n("78f8"),m=n("0e65"),v=n("9535"),g=n("c64f"),p=n("ba60"),b=n("8caa"),_=n("b68d"),w=b.UNSUPPORTED_Y,C=4294967295,x=Math.min,T=[].push,I=o(/./.exec),M=o(T),y=o("".slice),O=!_((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));s("split",(function(t,e,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var o=h(d(this)),s=void 0===n?C:n>>>0;if(0===s)return[];if(void 0===t)return[o];if(!c(t))return i(e,o,t,s);var r,u,l,f=[],m=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),g=0,b=new RegExp(t.source,m+"g");while(r=i(p,b,o)){if(u=b.lastIndex,u>g&&(M(f,y(o,g,r.index)),r.length>1&&r.index<o.length&&a(T,f,v(r,1)),l=r[0].length,g=u,f.length>=s))break;b.lastIndex===r.index&&b.lastIndex++}return g===o.length?!l&&I(b,"")||M(f,""):M(f,y(o,g)),f.length>s?v(f,0,s):f}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:i(e,this,t,n)}:e,[function(e,n){var a=d(this),s=void 0==e?void 0:m(e,t);return s?i(s,e,a,n):i(o,h(a),e,n)},function(t,a){var i=r(this),s=h(t),c=n(o,i,s,a,o!==e);if(c.done)return c.value;var d=u(i,RegExp),m=i.unicode,v=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(w?"g":"y"),p=new d(w?"^(?:"+i.source+")":i,v),b=void 0===a?C:a>>>0;if(0===b)return[];if(0===s.length)return null===g(p,s)?[s]:[];var _=0,T=0,I=[];while(T<s.length){p.lastIndex=w?0:T;var O,R=g(p,w?y(s,T):s);if(null===R||(O=x(f(p.lastIndex+(w?T:0)),s.length))===_)T=l(s,T,m);else{if(M(I,y(s,_,T)),I.length===b)return I;for(var j=1;j<=R.length-1;j++)if(M(I,R[j]),I.length===b)return I;T=_=O}}return M(I,y(s,_)),I}]}),!O,w)},"90fe":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));n("3fab"),n("89cf"),n("a9b6"),n("c284"),n("ed02");var a=n("5cf7"),i=n.n(a);function o(){return i.a.get("Thename")}function s(){return i.a.get("admin")}},9166:function(t,e,n){"use strict";n.r(e);var a,i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-page"},[n("div",{staticClass:"chat-page-head"},[t._v(" 当前在线人数"+t._s(t.num)+" ")]),n("div",{staticClass:"chat-page-body",attrs:{id:"msg_box"}},[t._l(t.histortist,(function(e,a){return n("div",{key:a,staticClass:"chatMsg"},[e.adm!=t.admin?n("div",{staticClass:"chatMsg-t1"},[t._v(t._s(e.Thename)+"说：")]):t._e(),e.adm!=t.admin?n("div",{staticClass:"chatMsg-t2"},[t._v(t._s(e.updataTime))]):t._e(),e.adm!=t.admin?n("div",{staticClass:"chatMsg-t3"},[t._v(t._s(e.content))]):t._e(),e.adm==t.admin?n("div",{staticClass:"chatMsg-t1 al gb"},[t._v(t._s(e.Thename)+"说：")]):t._e(),e.adm==t.admin?n("div",{staticClass:"chatMsg-t2 al gb"},[t._v(t._s(e.updataTime))]):t._e(),e.adm==t.admin?n("div",{staticClass:"chatMsg-t3 al gb"},[t._v(t._s(e.content))]):t._e()])})),n("div",{staticClass:"historyRecord"},[t._v("————历史纪录————")]),t._l(t.chatList,(function(e,a){return n("div",{key:a,staticClass:"chatMsg"},[e.adm!=t.admin?n("div",{staticClass:"chatMsg-t1"},[t._v(t._s(e.Thename)+"说：")]):t._e(),e.adm!=t.admin?n("div",{staticClass:"chatMsg-t2"},[t._v(t._s(e.updataTime))]):t._e(),e.adm!=t.admin?n("div",{staticClass:"chatMsg-t3"},[e.content?n("span",[t._v(t._s(e.content))]):t._e(),e.voice?n("span",{on:{click:function(n){return t.startVoice(e.voice)}}},[t._v("[点击播放语音]")]):t._e()]):t._e(),e.adm==t.admin?n("div",{staticClass:"chatMsg-t1 al gb"},[t._v(t._s(e.Thename)+"说：")]):t._e(),e.adm==t.admin?n("div",{staticClass:"chatMsg-t2 al gb"},[t._v(t._s(e.updataTime))]):t._e(),e.adm==t.admin?n("div",{staticClass:"chatMsg-t3 al gb"},[e.content?n("span",[t._v(t._s(e.content))]):t._e(),e.voice?n("span",{on:{click:function(n){return t.startVoice(e.voice)}}},[t._v("[点击播放语音]")]):t._e()]):t._e()])}))],2),n("div",{staticClass:"chat-page-bottom"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.con,expression:"con"}],attrs:{id:"",type:"text",name:""},domProps:{value:t.con},on:{input:function(e){e.target.composing||(t.con=e.target.value)}}}),t._v(" "),n("div",{staticClass:"sendop"},[n("div",{staticClass:"sendop-b1"},[n("button",{on:{click:function(e){t.show=!t.show}}},[t._v("颜艺")]),n("button",{on:{click:t.startRecord}},[t._v(t._s(t.isRecording?"录音中...":"点击录音"))])]),n("button",{on:{click:t.send}},[t._v("发送")])])]),n("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{staticClass:"emojBox"},t._l(t.emoji,(function(e,a){return n("div",{key:a,staticClass:"emojBox-items",on:{click:function(n){return t.selEmoj(e)}}},[t._v(" "+t._s(e)+" ")])})),0)])],1)},o=[],s=n("724c"),c=(n("53d1"),n("61ff")),r=(n("9cd1"),n("fd65")),d=(n("22ec"),n("bf33")),u=(n("3e22"),n("16e1"),n("365c")),l=n("90fe"),f=n("caaf"),h=n.n(f),m=n("7b04"),v=n.n(m),g={components:(a={},Object(s["a"])(a,d["a"].name,d["a"]),Object(s["a"])(a,r["a"].name,r["a"]),Object(s["a"])(a,c["a"].name,c["a"]),a),data:function(){return{show:!1,emoji:["w(ﾟДﾟ)w","ヽ(✿ﾟ▽ﾟ)ノ","(๑•̀ㅂ•́)و✧","(⊙﹏⊙)","┗|｀O′|┛","φ(≧ω≦*)♪","凸(艹皿艹 )","╰(*°▽°*)╯","（´Д`）","(#`O′)","(＠_＠;)","(ー`´ー)"],num:"",histortist:[],chatList:[],admin:Object(l["b"])(),Thename:Object(l["a"])(),con:"",ws:null,hub:"",noAdm:"",isRecording:!1,localId:"",serverId:"",openVoice:"",signature:""}},beforeRouteLeave:function(t,e,n){this.ws.close(),n()},created:function(){var t=this;if(!Object(l["b"])()){Object(d["a"])("您尚未登陆，将随机分配您的用户名");var e=(new Date).valueOf();console.log(String(e)),this.noAdm="匿名用户"+String(e).substr(7,10),console.log(this.noAdm),this.admin=this.noAdm,this.Thename=this.noAdm}t.getlatest(),this.ws=new WebSocket("wss://www.shenyifan.top/socket/"),this.ws.onopen=function(){console.log("握手成功")},this.ws.onmessage=function(e){console.log("message:"+e.data),JSON.parse(e.data).content||JSON.parse(e.data).voice?(t.chatList.push(JSON.parse(e.data)),t.$nextTick((function(){var t=document.getElementById("msg_box");t.scrollTop=t.scrollHeight}))):t.num=e.data},this.ws.onerror=function(){Object(d["a"])("socket连接以断开，请刷新页面"),console.log("error")},setTimeout((function(){var e=h()().format("MMMM Do YYYY, h:mm:ss a"),n={adm:t.admin,Thename:t.Thename,content:t.Thename+"加入了聊天室",updataTime:e};t.ws.send(JSON.stringify(n))}),2e3)},mounted:function(){var t=this;t.signature=sessionStorage.getItem("wxsignature"),t.signature&&v.a.config({debug:!1,appId:"wx3352249676449b29",timestamp:"1414587457",nonceStr:"syf",signature:t.signature,jsApiList:["checkJsApi","getLocation","scanQRCode","openLocation","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice"]}),v.a.onVoiceRecordEnd({complete:function(e){t.localId=e.localId,v.a.uploadVoice({localId:t.localId,isShowProgressTips:1,success:function(e){t.serverId=e.serverId,c["a"].confirm({title:"提示",message:"音频上传好了，是否发送呢？"}).then((function(){var e=h()().format("MMMM Do YYYY, h:mm:ss a"),n={adm:t.admin,Thename:t.Thename,content:"",updataTime:e,voice:t.serverId};t.ws.send(JSON.stringify(n))})).catch((function(){}))}})}})},methods:{send:function(){var t=this;if(t.isRecording)t.endAndSend();else{if(!this.con)return Object(d["a"])("请输入点什么"),!1;var e=h()().format("MMMM Do YYYY, h:mm:ss a"),n={adm:t.admin,Thename:t.Thename,content:String(t.con),updataTime:e};Object(u["r"])({admin:t.admin,content:t.con,Thename:t.Thename,updataTime:e}).then((function(t){})).catch((function(t){})),this.ws.send(JSON.stringify(n)),this.con=""}},getlatest:function(){var t=this;Object(u["s"])({}).then((function(e){console.log(e),t.histortist=e.data.errmsg,t.histortist.reverse(),console.log(t.histortist)})).catch((function(t){}))},selEmoj:function(t){this.con=this.con+t,this.show=!1},startRecord:function(){var t=this;this.isRecording?t.endAndSend():(this.isRecording=!0,v.a.startRecord())},startVoice:function(t){var e=this;Object(d["a"])("录音下载中..."),v.a.downloadVoice({serverId:t,isShowProgressTips:1,success:function(t){e.openVoice=t.localId,Object(d["a"])("录音播放中，请开大音量:D"),v.a.playVoice({localId:e.openVoice})}})},endAndSend:function(){var t=this;this.isRecording=!1,v.a.stopRecord({success:function(e){t.localId=e.localId,v.a.uploadVoice({localId:t.localId,isShowProgressTips:1,success:function(e){t.serverId=e.serverId,c["a"].confirm({title:"提示",message:"音频上传好了，是否发送呢？"}).then((function(){var e=h()().format("MMMM Do YYYY, h:mm:ss a"),n={adm:t.admin,Thename:t.Thename,content:"",updataTime:e,voice:t.serverId};t.ws.send(JSON.stringify(n))})).catch((function(){}))}})}})}}},p=g,b=(n("8923"),n("cba8")),_=Object(b["a"])(p,i,o,!1,null,null,null);e["default"]=_.exports},a3a6:function(t,e,n){"use strict";var a=n("b68d");t.exports=function(t,e){var n=[][t];return!!n&&a((function(){n.call(null,e||function(){throw 1},1)}))}},c284:function(t,e,n){var a=n("c6da"),i=n("3ec5"),o=n("77bc"),s=n("6ead"),c=n("d28a"),r=function(t){if(t&&t.forEach!==s)try{c(t,"forEach",s)}catch(e){t.forEach=s}};for(var d in i)i[d]&&r(a[d]&&a[d].prototype);r(o)}}]);