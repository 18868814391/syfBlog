(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a92229e"],{"151d":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("header",[s("span",{staticClass:"score"},[t._v("总分："+t._s(t.score))]),s("button",{staticClass:"star",on:{click:t.init}},[t._v("开始新的游戏")]),s("span",{staticClass:"sd"})]),s("div",{staticClass:"all-container"},[s("div",{staticClass:"background"},t._l(16,(function(t){return s("span")})),0),s("div",{staticClass:"container"},t._l(t.rocks,(function(e,n){return e?s("span",{key:n,staticClass:"list",style:"\n          zIndex: "+(e?e.num:0)+";\n          transform: translate("+t.cssTransition(e)+");\n        "},[s("span",{staticClass:"inner",style:"backgroundColor: "+(e?e.color:""),attrs:{id:"r"+(e&&e.id)}},[t._v(" "+t._s(e?e.num:"")+" ")])]):t._e()})),0)])])},i=[];const r=t=>(e,s)=>{const n=e[t],i=s[t];return n<i?-1:1},o=t=>new Promise(e=>setTimeout(e,t));var c={data(){return{msg:"",score:0,rocks:[],color:{2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#0444BF",1024:"#A79674",2048:"#282726",4096:"#280b21",8192:"#281d04"},directX:30}},mounted(){window.app=this,this.init(),document.addEventListener("keydown",t=>{switch(t.key.toLocaleUpperCase()){case"ARROWRIGHT":case"D":this.turn("right");break;case"ARROWLEFT":case"A":this.turn("left");break;case"ARROWDOWN":case"S":this.turn("down");break;case"ARROWUP":case"W":this.turn("up");break}}),document.addEventListener("touchstart",t=>{const e=s=>{s&&s.preventDefault();const n=s.touches[0].clientX-t.touches[0].clientX,i=s.touches[0].clientY-t.touches[0].clientY;n>this.directX?(this.turn("right"),document.removeEventListener("touchmove",e)):n<-this.directX?(this.turn("left"),document.removeEventListener("touchmove",e)):i>this.directX?(this.turn("down"),document.removeEventListener("touchmove",e)):i<-this.directX&&(this.turn("up"),document.removeEventListener("touchmove",e))};document.addEventListener("touchmove",e),document.addEventListener("touchend",()=>{document.removeEventListener("touchmove",e)})})},methods:{isMobile(){return window.navigator.userAgent.match(/Mobile/)},cssTransition(t){return this.isMobile()?`${23.5*(t?t.x:0)}vw, ${23.5*(t?t.y:0)}vw`:`${120*(t?t.x:0)}px, ${120*(t?t.y:0)}px`},init(){this.score=0,this.initRocks()},initRocks(){this.rocks=[],this.add(),this.add()},random24(){return Math.random()>.9?4:2},random0123(){return~~(4*Math.random())},createRock(){const t=this.random24(),e={x:this.random0123(),y:this.random0123(),num:t,id:this.rocks.length+1,color:this.color[t]},s=this.getRockByPoint({x:e.x,y:e.y});return s?this.createRock():e},isGameOver(){const t=this.isFull()&&this.rocks.filter(t=>t&&(3!==t.x||3!==t.y)).find(t=>{const e=this.getRockByPoint({x:t.x+1,y:t.y}),s=this.getRockByPoint({x:t.x,y:t.y+1});return t.num===(e&&e.num)||t.num===(s&&s.num)});return void 0===t},isSuccess(){const t=this.rocks.find(t=>t&&8192===t.num);return void 0!==t},isFull(){return this.rocks.filter(t=>t).length>15},add(){if(this.isFull())return!1;{const t=this.createRock();this.rocks.push(t)}},getRockByPoint({x:t,y:e}){return this.rocks.filter(t=>t).find(s=>s.x===t&&s.y===e)},getIndex(t){return this.rocks.findIndex(e=>e&&e.id===t)},handleDirect(t){return"right"===t?{handleArr:t=>t.filter(t=>t&&3!==t.x).sort(r("x")).reverse(),handleCondition:t=>t.x<3,next:t=>({x:t.x+1,y:t.y}),handleMove:t=>t.x++}:"left"===t?{handleArr:t=>t.filter(t=>t&&0!==t.x).sort(r("x")),handleCondition:t=>t.x>0,next:t=>({x:t.x-1,y:t.y}),handleMove(t){t.x--}}:"up"===t?{handleArr:t=>t.filter(t=>t&&0!==t.y).sort(r("y")),handleCondition:t=>t.y>0,next:t=>({x:t.x,y:t.y-1}),handleMove(t){t.y--}}:"down"===t?{handleArr:t=>t.filter(t=>t&&3!==t.y).sort(r("y")).reverse(),handleCondition:t=>t.y<3,next:t=>({x:t.x,y:t.y+1}),handleMove(t){t.y++}}:void 0},turn(t){this.rocks.forEach(t=>t&&(t.canCalc=!0)),Promise.all(this.handleDirect(t).handleArr(this.rocks).filter(t=>t).map(async e=>{var s=this.calcAxis({e:e,direct:t});return s})).then(t=>{if(t.indexOf(!0)>-1){if(this.isSuccess())return void this.$message.success("你真牛逼，你赢了，我服了");this.add()}else{if(this.isGameOver())return void this.$message.error("游戏结束请重新开始");if(this.isSuccess())return void this.$message.success("你真牛逼，你赢了，我服了")}setTimeout(()=>{},10)})},mergeNumericBlockAddStyle(t){const e=document.querySelector("#r"+t.id);e.animate([{transform:"scale(0.95)"},{transform:"scale(1.3)"},{transform:"scale(1.03)"},{transform:"scale(1)"}],{duration:200})},calcAxis({e:t,direct:e}){return new Promise(async(s,n)=>{let i=this.getRockByPoint(this.handleDirect(e).next(t));i&&i.num!==t.num?s(!1):i&&i.canCalc&&i.num===t.num?(this.handleDirect(e).handleMove(t),i.num*=2,this.score+=t.num,i.canCalc=!1,i.color=this.color[i.num],this.mergeNumericBlockAddStyle(i),await o(200),this.rocks.splice(this.getIndex(t.id),1,null),s(!0)):void 0===i&&(this.handleDirect(e).handleCondition(t)&&(this.handleDirect(e).handleMove(t),this.calcAxis({e:t,direct:e})),s(!0))})}}},a=c,d=(s("f644"),s("cba8")),h=Object(d["a"])(a,n,i,!1,null,null,null);e["default"]=h.exports},"4c9f":function(t,e,s){},f644:function(t,e,s){"use strict";s("4c9f")}}]);