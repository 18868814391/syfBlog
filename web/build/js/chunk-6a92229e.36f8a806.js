(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a92229e"],{"151d":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"layout"},[s("header",[s("span",{staticClass:"score"},[e._v("总分："+e._s(e.score))]),s("button",{staticClass:"star",on:{click:e.init}},[e._v("开始新的游戏")]),s("span",{staticClass:"sd"})]),s("div",{staticClass:"all-container"},[s("div",{staticClass:"background"},e._l(16,(function(e,t){return s("span",{key:t})})),0),s("div",{staticClass:"container"},e._l(e.rocks,(function(t,n){return s("span",{directives:[{name:"show",rawName:"v-show",value:t,expression:"e"}],key:n,staticClass:"list",style:"\n          zIndex: "+(t?t.num:0)+";\n          transform: translate("+e.cssTransition(t)+");\n        "},[s("span",{staticClass:"inner",style:"backgroundColor: "+(t?t.color:""),attrs:{id:"r"+(t&&t.id)}},[e._v(" "+e._s(t?t.num:"")+" ")])])})),0)])])},i=[];const r=e=>(t,s)=>{const n=t[e],i=s[e];return n<i?-1:1},o=e=>new Promise(t=>setTimeout(t,e));var c={data(){return{msg:"",score:0,rocks:[],color:{2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#0444BF",1024:"#A79674",2048:"#282726",4096:"#280b21",8192:"#281d04"},directX:30}},mounted(){window.app=this,this.init(),document.addEventListener("keydown",this.arrowMove),document.addEventListener("touchstart",this.fingerMove)},destroyed(){document.removeEventListener("touchstart",this.fingerMove,!0),document.removeEventListener("keydown",this.arrowMove,!0)},methods:{fingerMove(e){const t=s=>{const n=s.touches[0].clientX-e.touches[0].clientX,i=s.touches[0].clientY-e.touches[0].clientY;n>this.directX?(this.turn("right"),document.removeEventListener("touchmove",t)):n<-this.directX?(this.turn("left"),document.removeEventListener("touchmove",t)):i>this.directX?(this.turn("down"),document.removeEventListener("touchmove",t)):i<-this.directX&&(this.turn("up"),document.removeEventListener("touchmove",t))};document.addEventListener("touchmove",t),document.addEventListener("touchend",()=>{document.removeEventListener("touchmove",t)})},arrowMove(e){switch(e.key.toLocaleUpperCase()){case"ARROWRIGHT":case"D":this.turn("right");break;case"ARROWLEFT":case"A":this.turn("left");break;case"ARROWDOWN":case"S":this.turn("down");break;case"ARROWUP":case"W":this.turn("up");break}},isMobile(){return window.navigator.userAgent.match(/Mobile/)},cssTransition(e){return this.isMobile()?`${23.5*(e?e.x:0)}vw, ${23.5*(e?e.y:0)}vw`:`${120*(e?e.x:0)}px, ${120*(e?e.y:0)}px`},init(){this.score=0,this.initRocks()},initRocks(){this.rocks=[],this.add(),this.add()},random24(){return Math.random()>.9?4:2},random0123(){return~~(4*Math.random())},createRock(){const e=this.random24(),t={x:this.random0123(),y:this.random0123(),num:e,id:this.rocks.length+1,color:this.color[e]},s=this.getRockByPoint({x:t.x,y:t.y});return s?this.createRock():t},isGameOver(){const e=this.isFull()&&this.rocks.filter(e=>e&&(3!==e.x||3!==e.y)).find(e=>{const t=this.getRockByPoint({x:e.x+1,y:e.y}),s=this.getRockByPoint({x:e.x,y:e.y+1});return e.num===(t&&t.num)||e.num===(s&&s.num)});return void 0===e},isSuccess(){const e=this.rocks.find(e=>e&&8192===e.num);return void 0!==e},isFull(){return this.rocks.filter(e=>e).length>15},add(){if(this.isFull())return!1;{const e=this.createRock();this.rocks.push(e)}},getRockByPoint({x:e,y:t}){return this.rocks.filter(e=>e).find(s=>s.x===e&&s.y===t)},getIndex(e){return this.rocks.findIndex(t=>t&&t.id===e)},handleDirect(e){return"right"===e?{handleArr:e=>e.filter(e=>e&&3!==e.x).sort(r("x")).reverse(),handleCondition:e=>e.x<3,next:e=>({x:e.x+1,y:e.y}),handleMove:e=>e.x++}:"left"===e?{handleArr:e=>e.filter(e=>e&&0!==e.x).sort(r("x")),handleCondition:e=>e.x>0,next:e=>({x:e.x-1,y:e.y}),handleMove(e){e.x--}}:"up"===e?{handleArr:e=>e.filter(e=>e&&0!==e.y).sort(r("y")),handleCondition:e=>e.y>0,next:e=>({x:e.x,y:e.y-1}),handleMove(e){e.y--}}:"down"===e?{handleArr:e=>e.filter(e=>e&&3!==e.y).sort(r("y")).reverse(),handleCondition:e=>e.y<3,next:e=>({x:e.x,y:e.y+1}),handleMove(e){e.y++}}:void 0},turn(e){this.rocks.forEach(e=>e&&(e.canCalc=!0)),Promise.all(this.handleDirect(e).handleArr(this.rocks).filter(e=>e).map(async t=>{var s=this.calcAxis({e:t,direct:e});return s})).then(e=>{if(e.indexOf(!0)>-1){if(this.isSuccess())return void this.$message.success("你真牛逼，你赢了，我服了");this.add()}else{if(this.isGameOver())return void this.$message.error("游戏结束请重新开始");if(this.isSuccess())return void this.$message.success("你真牛逼，你赢了，我服了")}setTimeout(()=>{},10)})},mergeNumericBlockAddStyle(e){const t=document.querySelector("#r"+e.id);t&&t.animate&&t.animate([{transform:"scale(0.95)"},{transform:"scale(1.3)"},{transform:"scale(1.03)"},{transform:"scale(1)"}],{duration:200})},calcAxis({e:e,direct:t}){return new Promise(async(s,n)=>{let i=this.getRockByPoint(this.handleDirect(t).next(e));i&&i.num!==e.num?s(!1):i&&i.canCalc&&i.num===e.num?(this.handleDirect(t).handleMove(e),i.num*=2,this.score+=e.num,i.canCalc=!1,i.color=this.color[i.num],this.mergeNumericBlockAddStyle(i),await o(200),this.rocks.splice(this.getIndex(e.id),1,null),s(!0)):void 0===i&&(this.handleDirect(t).handleCondition(e)&&(this.handleDirect(t).handleMove(e),this.calcAxis({e:e,direct:t})),s(!0))})}}},a=c,d=(s("f644"),s("cba8")),h=Object(d["a"])(a,n,i,!1,null,null,null);t["default"]=h.exports},"4c9f":function(e,t,s){},f644:function(e,t,s){"use strict";s("4c9f")}}]);